# Observability

# Getting Started

Copilot can deploy the AWS OpenTelemetry Collector as a [sidecar](./sidecars.en.md) by setting the following in your manifest:
```yaml
observability:
  tracing: awsxray
```

Copilot will then deploy the AWS OpenTelemetry Collector using its [default configuration](https://github.com/aws-observability/aws-otel-collector/blob/main/config.yaml), which does the following:
- Receives [OpenTelemetry Protocol](https://github.com/open-telemetry/opentelemetry-specification/blob/main/specification/protocol/otlp.md) telemetry data on port `:4317` (GRPC) and `:55681` (HTTP)
- Receives AWS X-Ray traces (generated by the [AWS X-Ray SDK](https://docs.aws.amazon.com/xray/latest/devguide/xray-instrumenting-your-app.html#xray-instrumenting-xray-sdk)) on `:2000`
- Batches traces and metrics before exporting them
- Exports traces to AWS X-Ray and metrics to AWS CloudWatch Metrics

# Instrumenting Your Service
Instrumenting your service to send telemetry data is done through language-specific SDKs.
You can learn how to instrument a service in your language of choice with Open Telemetry SDKs [here](https://opentelemetry.io/docs/instrumentation/), or with AWS X-Ray SDKs [here](https://docs.aws.amazon.com/xray/latest/devguide/xray-instrumenting-your-app.html#xray-instrumenting-xray-sdk).

// TODO below

If your service is using AWS SDKs to interact with other AWS Services, you can instrument those API calls 

# Viewing Traces in AWS X-Ray Console
After you have instrumented your service and deployed it using Copilot, you're ready to view traces from your app! Depending on how you've instrumented your service, you will likely need to send a few requests to it before traces will appear in the AWS console.

First, open the CloudWatch console, and click on `X-Ray traces`/`Service map` in the menu. Here you can see a visual map of your services interacting:

// TODO IMG

Next, click on `Traces` in the menu. Here you can view traces generated by your service, and look at details about a speicifc trace:

// TODO IMG